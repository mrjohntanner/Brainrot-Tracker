<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SAB Brainrot Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --bg:#0b0f14;
  --panel:#0f1620;
  --panel2:#111b27;
  --text:#e8eef7;
  --muted:#8b97aa;
  --accent:#4da3ff;
  --danger:#ff4d4d;
  --radius:14px;
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:system-ui,-apple-system,Segoe UI,Roboto;
  background:var(--bg);
  color:var(--text);
}

header{
  padding:14px 20px;
  background:var(--panel);
  display:flex;
  gap:12px;
}

header button{
  background:none;
  border:none;
  color:var(--muted);
  font-size:15px;
  cursor:pointer;
}
header button.active{color:var(--accent)}

main{padding:20px}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(180px,1fr));
  gap:14px;
}

/* ================= RARITY GRADIENTS ================= */

.rarity-common{background:linear-gradient(135deg,#1e7f43,#34d399)}
.rarity-rare{background:linear-gradient(135deg,#1e3a8a,#3b82f6)}
.rarity-epic{background:linear-gradient(135deg,#4c1d95,#a855f7)}
.rarity-legendary{background:linear-gradient(135deg,#92400e,#facc15)}
.rarity-mythic{background:linear-gradient(135deg,#6d28d9,#c084fc)}
.rarity-brainrot-god{
  background:linear-gradient(
    135deg,
    #ff0000,
    #ff7f00,
    #ffff00,
    #00ff00,
    #0000ff,
    #8b00ff
  );
}
.rarity-secret{
  background:linear-gradient(135deg,#000,#fff);
  color:#fff;
}
.rarity-og{
  background:linear-gradient(135deg,#facc15,#000);
}
.rarity-festive{
  background:linear-gradient(135deg,#dc2626,#16a34a);
}
.rarity-admin{
  background:linear-gradient(135deg,#dc2626,#facc15);
}

/* ================= CARD ================= */

.card{
  border-radius:var(--radius);
  padding:12px;
  display:flex;
  flex-direction:column;
  gap:8px;
}

.card img{
  width:100%;
  height:140px;
  object-fit:contain;
  background:rgba(0,0,0,.35);
  border-radius:10px;
}

.card b{font-size:16px}
.card small{opacity:.9}

select,button,input{
  background:rgba(0,0,0,.35);
  color:#fff;
  border:1px solid rgba(255,255,255,.15);
  border-radius:6px;
  padding:6px;
}

button{cursor:pointer}

.base-header{
  display:flex;
  gap:10px;
  align-items:center;
  margin-bottom:12px;
}

.br-row{
  margin-top:10px;
  border-top:1px solid rgba(255,255,255,.2);
  padding-top:10px;
}

.traits{
  display:flex;
  flex-wrap:wrap;
  gap:6px;
  margin-top:6px;
}

.traits label{font-size:12px}

.remove{
  color:#fff;
  opacity:.8;
  font-size:12px;
  cursor:pointer;
}
.remove:hover{opacity:1}
</style>
</head>
<body>

<header>
  <button id="tabIndex" class="active">Index</button>
  <button id="tabBases">My Bases</button>
</header>

<main id="app"></main>

<script>
/* ================= DATA ================= */

const MUTATIONS = ["None","Golden","Shadow","Corrupted"];
const TRAITS = ["Fast","Lucky","Heavy","Glitched"];

/* EXAMPLE DATA â€” replace / extend freely */
const ALL_BRAINROTS = [
  { id:"meowl", name:"Meowl", rarity:"Common" },
  { id:"festive_67", name:"Festive 67", rarity:"Festive" },
  { id:"brainrot_god", name:"Brainrot God", rarity:"Brainrot God" }
];

/* ================= HELPERS ================= */

function rarityClass(r){
  return "rarity-" + r.toLowerCase().replace(/\s+/g,"-");
}

function wikiImage(name){
  const title = name.replace(/ /g,"_");
  return `https://static.wikia.nocookie.net/stealabr/images/Special:FilePath/${title}`;
}

/* ================= STORAGE ================= */

function loadBases(){
  try{
    return JSON.parse(localStorage.getItem("sabBases")) || {};
  }catch{
    return {};
  }
}
function saveBases(){
  localStorage.setItem("sabBases",JSON.stringify(bases));
}

/* ================= MIGRATION ================= */

function normalizeBrainrots(list){
  return list.map(br=>{
    if(typeof br==="string"){
      return {id:br,mutation:null,traits:[]};
    }
    return br;
  });
}

/* ================= STATE ================= */

let bases = loadBases();
if(Object.keys(bases).length===0){
  bases["Main"]={brainrots:[]};
}
Object.values(bases).forEach(b=>{
  b.brainrots=normalizeBrainrots(b.brainrots);
});

let currentTab="index";
let selectedBase=Object.keys(bases)[0];
const app=document.getElementById("app");

/* ================= TABS ================= */

document.getElementById("tabIndex").onclick=()=>{
  currentTab="index";render();
};
document.getElementById("tabBases").onclick=()=>{
  currentTab="bases";render();
};

function render(){
  document.querySelectorAll("header button")
    .forEach(b=>b.classList.remove("active"));
  document.getElementById(
    currentTab==="index"?"tabIndex":"tabBases"
  ).classList.add("active");

  currentTab==="index"?renderIndex():renderBases();
}

/* ================= INDEX ================= */

function renderIndex(){
  app.innerHTML=`
    <div class="grid">
      ${ALL_BRAINROTS.map(br=>`
        <div class="card ${rarityClass(br.rarity)}">
          <img
            loading="lazy"
            src="${wikiImage(br.name)}"
            onerror="this.style.display='none'"
          >
          <div>
            <b>${br.name}</b><br>
            <small>${br.rarity}</small>
          </div>
          <button onclick="addBrainrot('${br.id}')">Add</button>
        </div>
      `).join("")}
    </div>
  `;
}

function addBrainrot(id){
  bases[selectedBase].brainrots.push({
    id,mutation:null,traits:[]
  });
  saveBases();
}

/* ================= BASES ================= */

function renderBases(){
  const missing=getMissing(selectedBase).length;

  app.innerHTML=`
    <div class="base-header">
      <select onchange="changeBase(this.value)">
        ${Object.keys(bases).map(b=>`
          <option ${b===selectedBase?"selected":""}>${b}</option>
        `).join("")}
      </select>

      <button onclick="exportBases()">Export</button>
      <input type="file" onchange="importBases(this.files[0])">
      <small>Missing: ${missing}</small>
    </div>

    ${bases[selectedBase].brainrots.map((br,i)=>{
      const data=ALL_BRAINROTS.find(b=>b.id===br.id)||{};
      return `
        <div class="card ${rarityClass(data.rarity||"common")} br-row">
          <b>${data.name||br.id}</b>
          <small>${data.rarity||""}</small>

          <div>
            Mutation:
            <select onchange="updateBrainrot(${i},this.value)">
              ${MUTATIONS.map(m=>`
                <option ${
                  br.mutation===m||(!br.mutation&&m==="None")
                  ?"selected":""
                }>${m}</option>
              `).join("")}
            </select>
          </div>

          <div class="traits">
            ${TRAITS.map(t=>`
              <label>
                <input type="checkbox"
                  ${br.traits.includes(t)?"checked":""}
                  onchange="toggleTrait(${i},'${t}')">
                ${t}
              </label>
            `).join("")}
          </div>

          <div class="remove" onclick="removeBrainrot(${i})">
            Remove
          </div>
        </div>
      `;
    }).join("")}
  `;
}

/* ================= LOGIC ================= */

function changeBase(name){selectedBase=name;render();}
function updateBrainrot(i,val){
  bases[selectedBase].brainrots[i].mutation=val==="None"?null:val;
  saveBases();
}
function toggleTrait(i,t){
  const arr=bases[selectedBase].brainrots[i].traits;
  const idx=arr.indexOf(t);
  idx>-1?arr.splice(idx,1):arr.push(t);
  saveBases();
}
function removeBrainrot(i){
  bases[selectedBase].brainrots.splice(i,1);
  saveBases();render();
}
function getMissing(base){
  const owned=new Set(bases[base].brainrots.map(b=>b.id));
  return ALL_BRAINROTS.filter(b=>!owned.has(b.id));
}

/* ================= IMPORT / EXPORT ================= */

function exportBases(){
  const blob=new Blob([JSON.stringify(bases,null,2)],{type:"application/json"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="sab-bases.json";
  a.click();
}
function importBases(file){
  const r=new FileReader();
  r.onload=e=>{
    try{
      bases=JSON.parse(e.target.result);
      saveBases();render();
    }catch{alert("Invalid JSON");}
  };
  r.readAsText(file);
}

/* ================= INIT ================= */

render();
</script>
</body>
</html>
